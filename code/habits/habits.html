<!DOCTYPE html>

<html>

<head>
    <title>Habits</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Figtree:ital,wght@0,300..900;1,300..900&display=swap"
        rel="stylesheet">

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" type="text/css" href="habits.css" />
    <link rel="stylesheet" href="../main.css">
</head>

<body>
    <div id="mobile">
        <header>
            <h1>Add/Edit Habits</h1>    
        </header>

        <main>
            <a href="addhabits.html">
                <button class="button" id="Add"> Add Habits </button>
            </a>
            
            <h2> Current Habits</h2>

            <div class = "curr-habits"></div>

            <button class="button" id="DemoDone">Demo Done!</button>
        </main>



        <script>
            // General Function structure credited to ChatGPT to understand how to move things between several html files like this
            window.addEventListener("DOMContentLoaded", () => {
            const headerContainer = document.getElementsByClassName("curr-habits")[0];
            const wentToAddHabit = JSON.parse(localStorage.getItem("cameBack?")); 
            if (wentToAddHabit) {
                const habitList = JSON.parse(localStorage.getItem("habitData")); 

                if (habitList.length > 0) {
                habitList.forEach(habit => {
                    const habitDiv = document.createElement('div');  
                    let html = "";
                    for (let key in habit) {
                      if (key == "Habit") {
                        html += `<span><p><strong>${key}:</strong> ${habit[key]}</p></span><br>`;
                      } else {
                        html += `<p><strong>${key}:</strong> ${habit[key]}</p><br>`;
                      }
                    }
                    habitDiv.innerHTML = html + `<a href="edithabits.html"> <button id="Edit-Habit">Edit Habit</button> </a>`;
                    headerContainer.appendChild(habitDiv);
                    localStorage.removeItem("cameBack?");
                });
                }
                
            }
            });

            document.getElementById('DemoDone').addEventListener('click', function() {
              localStorage.clear();
              location.reload()
            });

            document.getElementById('Edit-Habit').addEventListener('click', function() {
              const parentDiv = this.closest('.habit')
              // var habitStatement = parentDiv.querySelector('span').textContent.trim();
              // var parts = text.split(":");
              // var habitName = parts[1].trim();

              localStorage.setItem("edit", JSON.stringify(parentDiv));
              location.reload()
            });

        </script>

        
        <script src="../elements/navbar.js"></script>
        <custom-navbar></custom-navbar>
    </div>
</body>
</html>