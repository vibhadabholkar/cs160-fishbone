<!DOCTYPE html>

<html>
  <head>
    <title>Add Habit</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap"
      rel="stylesheet"
    />

    <!-- For the AM/PM Toggle on the Clock -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="stylesheet" href="../main.css">
    <link rel="stylesheet" type="text/css" href="habits.css" />
  </head>
  <body>
    <header>
      <h1>Create New Habit</h1>      
    </header>

    <main>
        <div class="Add-Habit">
            <label for="habitname">Habit Name: </label>
            <input type="text" id="habitname" name="Habit" placeholder="Enter the habit you want to create."><br>
            <br>

            <label for="freq">Frequency: </label><br>

            <input type="radio" id="freq-button-group-daily"  name="Frequency" value="Daily">
            <label for="daily">Daily</label><br>

            <input type="radio" id="freq-button-group-weekly" name="Frequency" value="Weekly">
            <label for="weekly">Weekly</label><br>

            <input type="radio" id="freq-button-group-custom" name="Frequency" value="Custom">
            <label for="custom">Custom</label><br><br>
           
            <!-- <div class="button-group" name="Frequency" id="freq-button-group">
                <button class="active">Daily</button>
                <button>Weekly</button>
                <button>Custom</button>
            </div>
            <br> -->

            <label for="tod">Preferred Time of Day: </label>
            <input id="timepicker" name="Preferred Time of Day" type="text" placeholder="Select the time of day you would like to do this habit.">
            <br><br>

            <label for="target">Target: </label>
            <input type="text" id="target" name="Target" placeholder="Enter your target for this habit.">
            <br><br>

            <label for="notes">Description/Additional Notes: </label>
            <input type="text" id="notes" name="Description/Additional Notes" placeholder="Add any description or additional notes you want to include about this habit.">
            <br><br>
            <!-- <a href="habits.html"> -->
            <button class="btn btn-primary" id="Done">Done!</button>
            <!-- </a> -->

        </div>

    
    </main>

    
    <script>
        flatpickr("#timepicker", {
            enableTime: true,
            noCalendar: true,
            dateFormat: "h:i K", // 12-hour with AM/PM
        });

         // General Function structure credited to ChatGPT to understand how to move things between several html files like this
        function habitStorer() {
          var habitDiv = document.getElementsByClassName("Add-Habit")[0];
          var inputs = habitDiv.querySelectorAll("input");

          let data = {};
          inputs.forEach(input => {
            if (input.name == "Frequency") {
              const reminderFreq = document.querySelector('input[name="Frequency"]:checked');
              data[input.name] = reminderFreq.value;
            } else {
              data[input.name] = input.value;
            }
          });

          let habitList = JSON.parse(localStorage.getItem("habitData")) || [];
          habitList.push(data);

          localStorage.setItem("habitData", JSON.stringify(habitList));
        }


        document.getElementById('Done').addEventListener('click', function() {
          habitStorer();
          localStorage.setItem("cameBack?", true);
          location.assign("habits.html");
        });

    
    </script>
  </body>
</html>
